# 现货-合约对冲策略说明

## 1. 策略概述

这是一个基于现货和合约市场的对冲策略，通过在现货市场做多同时在合约市场做空来获取无风险收益。策略主要利用以下几个方面的市场机会：
- 现货和合约之间的基差
- 合约市场的资金费率
- 动态调整的对冲比例

## 2. 核心要素

### 2.1 基差交易
- **定义**：基差 = 合约价格 - 现货价格
- **计算**：基差率 = (合约价格 - 现货价格) / 现货价格
- **交易逻辑**：
  - 当基差为正时，可以通过现货做多+合约做空获利
  - 当基差为负时，需要考虑资金费率的补偿

### 2.2 资金费率
- **定义**：合约市场每8小时结算一次的费用
- **计算周期**：每8小时
- **费用方向**：
  - 正费率：多头付给空头
  - 负费率：空头付给多头
- **策略应用**：
  - 高资金费率时调整对冲比例
  - 根据费率方向增减合约仓位

### 2.3 对冲比例
- **基础比例**：0.8（80%对冲）
- **动态范围**：0.5-1.0
- **调整条件**：
  - 资金费率超过阈值时触发
  - 基差变化超过阈值时触发

## 3. 策略参数

### 3.1 核心参数
```python
params = (
    ('hedge_ratio', 0.8),        # 基础对冲比例
    ('funding_threshold', 0.001), # 资金费率阈值
    ('position_size', 1.0),      # 基础仓位大小
    ('leverage', 3),             # 合约杠杆倍数
)
```

### 3.2 参数说明
- **hedge_ratio**: 初始对冲比例，表示合约端的对冲比例
- **funding_threshold**: 触发对冲比例调整的资金费率阈值
- **position_size**: 单次交易的基础仓位大小
- **leverage**: 合约端使用的杠杆倍数

## 4. 交易逻辑

### 4.1 入场条件
1. **基础策略**：
   - 在现货市场建立多头仓位
   - 在合约市场建立对应的空头仓位
   
2. **仓位大小**：
   ```python
   spot_size = position_size
   futures_size = spot_size * hedge_ratio
   ```

### 4.2 动态调整
1. **资金费率触发**：
   - 当资金费率 > threshold：减少合约空头
   - 当资金费率 < -threshold：增加合约空头

2. **对冲比例调整**：
   ```python
   if funding_rate > threshold:
       new_ratio = max(0.5, current_ratio - 0.1)
   elif funding_rate < -threshold:
       new_ratio = min(1.0, current_ratio + 0.1)
   ```

## 5. 风险管理

### 5.1 头寸控制
- 单笔交易风险限制在账户的2%以内
- 合约端使用适度杠杆（3倍）
- 动态调整对冲比例控制风险

### 5.2 风险监控
- 实时监控基差变化
- 监控资金费率变化
- 跟踪对冲效果

## 6. 策略优势

1. **低风险**：
   - 多空对冲，市场中性
   - 不受单一方向影响
   - 风险可控

2. **稳定收益**：
   - 基差收益
   - 资金费率收益
   - 波动率收益

3. **灵活性**：
   - 动态调整对冲比例
   - 适应市场变化
   - 可根据条件调整策略

## 7. 注意事项

### 7.1 成本控制
- 考虑交易手续费
- 考虑滑点成本
- 考虑资金费率成本

### 7.2 执行要点
- 确保现货和合约同步交易
- 注意基差突变风险
- 关注资金费率变化

### 7.3 风险提示
- 市场流动性风险
- 交易所系统风险
- 对冲失效风险

## 8. 回测结果分析

### 8.1 性能指标
- 年化收益率
- 最大回撤
- 夏普比率
- 胜率统计

### 8.2 优化方向
- 对冲比例的动态调整
- 资金费率阈值的优化
- 交易成本的控制

## 9. 实盘建议

### 9.1 准备工作
- 确保API权限完整
- 测试下单功能
- 检查资金充足

### 9.2 监控重点
- 实时监控基差
- 跟踪资金费率
- 观察对冲效果

### 9.3 应急预案
- 系统故障应对
- 市场异常处理
- 风控措施触发 